# SIEVE ç¼“å­˜æ·˜æ±°ç®—æ³•å®éªŒæŠ¥å‘Š

## ğŸ“‹ å¿«é€Ÿå¼€å§‹ (ä¸€é”®å¤ç°)

```bash
cd /home/ftj/NSDI24-SIEVE

# å¿«é€Ÿå®éªŒ (~5åˆ†é’Ÿ): Zipf Î±={0.8, 1.0, 1.2}
./run_all.sh --quick

# å®Œæ•´å®éªŒ (~30åˆ†é’Ÿ): åŒ…å«æ‰€æœ‰å‚æ•°å’ŒçœŸå®trace
./run_all.sh --full

# ä»…ç”Ÿæˆå›¾è¡¨ (ä½¿ç”¨å·²æœ‰ç»“æœ)
./run_all.sh --plot

# è¿è¡ŒCase Study
python3 case_study.py
```

---

## 1. å®éªŒç¯å¢ƒé…ç½®

### 1.1 ç³»ç»Ÿç¯å¢ƒ
- **æ“ä½œç³»ç»Ÿ**: Linux
- **é¡¹ç›®è·¯å¾„**: `/home/ftj/NSDI24-SIEVE`
- **æ¨¡æ‹Ÿå™¨**: libCacheSim (é«˜æ€§èƒ½ç¼“å­˜æ¨¡æ‹Ÿå™¨)

### 1.2 ä¾èµ–é¡¹
```bash
apt install build-essential cmake zstd
pip install numpy matplotlib
```

### 1.3 æ‰‹åŠ¨è¿è¡Œå•ä¸ªå®éªŒ
```bash
# ç”ŸæˆZipf trace (Î±=1.0, 10000å¯¹è±¡, 100ä¸‡è¯·æ±‚)
python3 libCacheSim/scripts/data_gen.py -m 10000 -n 1000000 --alpha 1.0 > mydata/zipf/test_trace

# è¿è¡Œcachesim
./libCacheSim/_build/bin/cachesim mydata/zipf/test_trace txt sieve 500 --ignore-obj-size 1

# è¿è¡Œå‹ç¼©çš„çœŸå®trace
./libCacheSim/_build/bin/cachesim cluster45.oracleGeneral.zst oracleGeneral sieve 100MB -n 1000000
```

---

## 2. ä»“åº“ç»“æ„

```
NSDI24-SIEVE/
â”œâ”€â”€ run_all.sh                   # ğŸ”¥ ä¸€é”®è¿è¡Œè„šæœ¬
â”œâ”€â”€ run_experiments.py           # å®éªŒè‡ªåŠ¨åŒ–è„šæœ¬
â”œâ”€â”€ plot_results.py              # å¯è§†åŒ–è„šæœ¬
â”œâ”€â”€ case_study.py                # Case Studyè„šæœ¬
â”œâ”€â”€ libCacheSim/
â”‚   â”œâ”€â”€ libCacheSim/cache/eviction/
â”‚   â”‚   â”œâ”€â”€ Sieve.c              # SIEVEç®—æ³•å®ç°
â”‚   â”‚   â”œâ”€â”€ GhostSieve.c         # GhostSIEVEæ”¹è¿›ç‰ˆ
â”‚   â”‚   â”œâ”€â”€ LRU.c, FIFO.c, Clock.c
â”‚   â””â”€â”€ _build/bin/cachesim      # ç¼–è¯‘åçš„æ¨¡æ‹Ÿå™¨
â”œâ”€â”€ mydata/zipf/                 # ç”Ÿæˆçš„Zipf traces
â”œâ”€â”€ cluster45.oracleGeneral.zst  # TwitterçœŸå®trace (1.7GB)
â””â”€â”€ experiment_results/
    â”œâ”€â”€ zipf_full_results.csv    # Zipfå®éªŒæ•°æ®
    â”œâ”€â”€ cluster45_results.csv    # çœŸå®traceæ•°æ®
    â”œâ”€â”€ figures/                 # æ‰€æœ‰å›¾è¡¨
    â””â”€â”€ REPORT.md                # æœ¬æŠ¥å‘Š
```

---

## 3. ç®—æ³•åŸç†

### 3.1 SIEVEç®—æ³•æ ¸å¿ƒ
```c
// æ•°æ®ç»“æ„: åŒå‘é“¾è¡¨ + æ‰«ææŒ‡é’ˆ
typedef struct {
  cache_obj_t *q_head;    // é˜Ÿåˆ—å¤´ (æœ€æ–°)
  cache_obj_t *q_tail;    // é˜Ÿåˆ—å°¾ (æœ€æ—§)
  cache_obj_t *pointer;   // æ‰«ææŒ‡é’ˆ ("æ‰‹")
} Sieve_params_t;
```

**å·¥ä½œæµç¨‹**:
1. **æ’å…¥**: æ–°å¯¹è±¡â†’é˜Ÿå¤´, `visited=0`
2. **å‘½ä¸­**: è®¾ç½® `visited=1`, **ä¸ç§»åŠ¨ä½ç½®** (å…³é”®ä¼˜åŒ–!)
3. **æ·˜æ±°**: æŒ‡é’ˆæ‰«æ, `visited=1`â†’æ¸…é›¶ç»§ç»­, `visited=0`â†’æ·˜æ±°

### 3.2 ä¸LRUå¯¹æ¯”

| æ“ä½œ | LRU | SIEVE |
|-----|-----|-------|
| å‘½ä¸­ | ç§»åŠ¨åˆ°é˜Ÿå¤´ (O(1)ä½†éœ€ä¿®æ”¹æŒ‡é’ˆ) | ä»…è®¾ç½®bit (æ›´å¿«) |
| æ·˜æ±° | ç›´æ¥åˆ é˜Ÿå°¾ | æ‰«ææ‰¾unvisited |
| ç©ºé—´ | 2ä¸ªæŒ‡é’ˆ/å¯¹è±¡ | 1 bit/å¯¹è±¡ |

---

## 4. å®Œæ•´å®éªŒç»“æœ

### 4.1 Zipfåˆ†å¸ƒå®éªŒå¤§è¡¨ (å‘½ä¸­ç‡ %)

**å®éªŒé…ç½®**: 10,000å¯¹è±¡, 1,000,000è¯·æ±‚

| Î± | Cache | FIFO | LRU | Clock | **SIEVE** | GhostSIEVE | SIEVE-LRU |
|---|-------|------|-----|-------|-----------|------------|-----------|
| **0.6** | 100 | 4.0 | 4.3 | 4.6 | **12.2** | *11.3* | +7.9% |
| | 500 | 13.6 | 15.1 | 15.9 | **25.5** | *23.5* | +10.4% |
| | 1000 | 22.0 | 24.4 | 25.3 | **35.0** | *32.0* | +10.6% |
| **0.7** | 100 | 7.4 | 8.4 | 9.1 | **19.0** | *17.9* | +10.6% |
| | 500 | 20.2 | 22.8 | 23.9 | **34.9** | *32.4* | +12.1% |
| | 1000 | 29.6 | 33.0 | 34.2 | **43.7** | *41.2* | +10.7% |
| **0.8** | 100 | 13.4 | 15.7 | 16.7 | **27.8** | *26.6* | +12.1% |
| | 500 | 29.4 | 33.1 | 34.4 | **45.4** | *42.8* | +12.3% |
| | 1000 | 39.4 | 43.6 | 44.9 | **54.0** | *51.6* | +10.4% |
| **0.9** | 100 | 22.5 | 26.2 | 27.5 | **39.0** | *37.6* | +12.8% |
| | 500 | 41.0 | 45.5 | 46.8 | **56.7** | *54.5* | +11.2% |
| | 1000 | 51.0 | 55.6 | 56.8 | **64.7** | *62.6* | +9.1% |
| **1.0** | 100 | 52.0 | 57.5 | 58.9 | **67.1** | *64.6* | +9.6% |
| | 500 | 83.2 | 86.7 | *87.1* | **89.5** | 86.8 | +2.8% |
| | 1000 | 99.9 | 99.9 | 99.9 | **99.9** | 99.9 | 0.0% |
| **1.1** | 100 | 47.5 | 52.9 | 54.2 | **63.3** | *62.0* | +10.4% |
| | 500 | 66.5 | 70.9 | 71.9 | **77.8** | *76.5* | +6.9% |
| | 1000 | 74.2 | 78.1 | 78.8 | **83.0** | *81.9* | +4.9% |
| **1.2** | 100 | 60.4 | 65.7 | 66.8 | **73.8** | *72.7* | +8.1% |
| | 500 | 77.2 | 80.9 | 81.6 | **85.6** | *84.7* | +4.7% |
| | 1000 | 83.2 | 86.2 | 86.7 | **89.3** | *88.7* | +3.1% |
| **1.3** | 100 | 71.5 | 76.2 | 77.1 | **82.1** | *81.3* | +5.9% |
| | 500 | 85.4 | 88.1 | 88.6 | **91.2** | *90.5* | +3.1% |
| | 1000 | 89.6 | 91.7 | 92.1 | **93.6** | *93.3* | +1.9% |
| **1.4** | 100 | 80.2 | 84.1 | 84.7 | **88.4** | *87.6* | +4.3% |
| | 500 | 91.0 | 92.9 | 93.2 | **94.7** | *94.4* | +1.8% |
| | 1000 | 93.9 | 95.3 | 95.5 | **96.4** | *96.2* | +1.1% |

> **å›¾ä¾‹**: **åŠ ç²—** = æœ€ä½³, *æ–œä½“* = ç¬¬äºŒå¥½

### 4.2 çœŸå®Traceå®éªŒ (Twitter cluster45)

| Cache Size | FIFO | LRU | Clock | **SIEVE** | GhostSIEVE |
|------------|------|-----|-------|-----------|------------|
| 10 MB | 49.2% | 50.3% | 50.8% | *52.2%* | **52.4%** |
| 50 MB | 55.0% | 55.9% | *56.0%* | 55.9% | **56.0%** |
| 100 MB | 56.4% | **56.8%** | **56.8%** | **56.8%** | **56.8%** |
| 200 MB | **56.8%** | **56.8%** | **56.8%** | **56.8%** | **56.8%** |

### 4.3 ååé‡å¯¹æ¯” (MQPS)

| ç®—æ³• | Zipf Trace | Real Trace |
|------|------------|------------|
| FIFO | *4.06* | *5.52* |
| LRU | 3.97 | 5.11 |
| Clock | 4.02 | 5.35 |
| **SIEVE** | **4.21** | **5.70** |
| GhostSIEVE | 3.56 | 4.37 |

---

## 5. Case Study: ç¼“å­˜çŠ¶æ€å¯è§†åŒ–

è¿è¡Œä»¥ä¸‹å‘½ä»¤ç”Ÿæˆå¯è§†åŒ–:
```bash
python3 case_study_visual.py  # é€æ­¥å¯è§†åŒ–
python3 case_study.py         # æ€§èƒ½åˆ†æ
```

### 5.1 SIEVE vs LRU é€æ­¥å¯¹æ¯”

**åœºæ™¯è®¾è®¡** (è§ `case_study_step_by_step.png`):
- ç¼“å­˜å®¹é‡: 3
- è®¿é—®åºåˆ—: `A, B, C, A, B, X, Y, A, B, C`
- å·¥ä½œé›†: A, B, C (éœ€è¦ä¿ç•™)
- æ‰«æå¯¹è±¡: X, Y (ä¸€æ¬¡æ€§è®¿é—®)

**å…³é”®å·®å¼‚**:

| æ­¥éª¤ | è®¿é—® | SIEVE | LRU |
|------|------|-------|-----|
| 1-3 | A,B,C | å¡«å……ç¼“å­˜ | å¡«å……ç¼“å­˜ |
| 4-5 | A,B | **HIT** (è®¾visited=1, ä¸ç§»åŠ¨) | HIT (ç§»åŠ¨åˆ°å‰é¢) |
| 6 | X | æ·˜æ±°C (visited=0) | æ·˜æ±°A (LRUä½ç½®) |
| 7 | Y | æ·˜æ±°X (visited=0, å¿«é€Ÿæ·˜æ±°!) | æ·˜æ±°B (LRUä½ç½®) |
| 8-9 | A,B | **HIT!** (A,Bä»åœ¨ç¼“å­˜) | **MISS** (A,Bè¢«æ·˜æ±°äº†) |
| 10 | C | MISS | MISS |

**ç»“æœ**: SIEVE 30% å‘½ä¸­ç‡ vs LRU 20% å‘½ä¸­ç‡ (+10%)

### 5.2 ä¸ºä»€ä¹ˆSIEVEæ›´å¥½?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LRU çš„é—®é¢˜:                                            â”‚
â”‚  â€¢ å‘½ä¸­æ—¶ç§»åŠ¨å¯¹è±¡åˆ°é˜Ÿå¤´                                  â”‚
â”‚  â€¢ æ‰«æå¯¹è±¡ X, Y ä¼šæŠŠå·¥ä½œé›† A, B æŒ¤åˆ°é˜Ÿå°¾               â”‚
â”‚  â€¢ å·¥ä½œé›†è¢«é”™è¯¯æ·˜æ±°!                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  SIEVE çš„è§£å†³æ–¹æ¡ˆ:                                      â”‚
â”‚  â€¢ å‘½ä¸­æ—¶ä»…è®¾ç½® visited=1 (ä¸ç§»åŠ¨!)                     â”‚
â”‚  â€¢ å·¥ä½œé›†ä¿æŒ visited=1, å—åˆ°ä¿æŠ¤                       â”‚
â”‚  â€¢ æ‰«æå¯¹è±¡ visited=0, å¾ˆå¿«è¢«æ·˜æ±°                       â”‚
â”‚  â€¢ è¿”å›å·¥ä½œé›†æ—¶ â†’ HIT!                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 æ€§èƒ½éšç¼“å­˜å¤§å°å˜åŒ–

| Cache Size | SIEVE Hit% | LRU Hit% | **ä¼˜åŠ¿** |
|------------|------------|----------|----------|
| 50 | 57.5% | 46.0% | **+11.5%** |
| 100 | 67.1% | 57.5% | **+9.6%** |
| 200 | 76.7% | 69.7% | **+7.0%** |
| 500 | 89.5% | 86.7% | **+2.8%** |
| 1000 | 99.9% | 99.9% | 0.0% |

**å…³é”®å‘ç°**: 
- ç¼“å­˜è¶Šå°, SIEVEä¼˜åŠ¿è¶Šæ˜æ˜¾ (å°ç¼“å­˜æ—¶æå‡10%+)
- å½“ç¼“å­˜èƒ½å®¹çº³æ•´ä¸ªå·¥ä½œé›†æ—¶, æ‰€æœ‰ç®—æ³•è¶‹åŒ

### 5.4 Zipf Î±å‚æ•°å¯¹æ€§èƒ½çš„å½±å“

```
Î±=0.8 (ä½å±€éƒ¨æ€§): Top 10å¯¹è±¡å  27% è®¿é—® â†’ SIEVEä¼˜åŠ¿å¤§
Î±=1.0 (ä¸­å±€éƒ¨æ€§): Top 10å¯¹è±¡å  54% è®¿é—® â†’ SIEVEä¼˜åŠ¿ä¸­ç­‰
Î±=1.2 (é«˜å±€éƒ¨æ€§): Top 10å¯¹è±¡å  74% è®¿é—® â†’ SIEVEä¼˜åŠ¿è¾ƒå°
```

---

## 6. ç”Ÿæˆçš„å›¾è¡¨æ¸…å•

| æ–‡ä»¶ | æè¿° |
|------|------|
| `figure_a_hit_rate_vs_cache_size.png` | å‘½ä¸­ç‡ vs ç¼“å­˜å¤§å°æ›²çº¿ |
| `figure_b_zipf_alpha_comparison.png` | ä¸åŒÎ±çš„ç®—æ³•å¯¹æ¯”æŸ±çŠ¶å›¾ |
| `figure_c_throughput_comparison.png` | ååé‡å¯¹æ¯” |
| `figure_d_sieve_improvement.png` | SIEVE vs GhostSIEVE |
| `figure_e_real_trace_hit_rate.png` | çœŸå®traceå‘½ä¸­ç‡ |
| `figure_f_real_trace_throughput.png` | çœŸå®traceååé‡ |
| `case_study_step_by_step.png` | **ğŸ”¥ ç¼“å­˜çŠ¶æ€é€æ­¥å¯è§†åŒ–** |
| `case_study_summary.png` | **ğŸ”¥ SIEVE vs LRU å¯¹æ¯”æ€»ç»“** |
| `case_study_zipf_distribution.png` | Zipfåˆ†å¸ƒå¯è§†åŒ– |
| `case_study_performance_scaling.png` | æ€§èƒ½éšç¼“å­˜å˜åŒ– |

---

## 7. ç»“è®º

1. **SIEVEæ˜¾è‘—ä¼˜äºä¼ ç»Ÿç®—æ³•**: åœ¨Zipfåˆ†å¸ƒä¸‹, SIEVEæ¯”LRUå¹³å‡é«˜å‡º **8-12%** å‘½ä¸­ç‡
2. **ç®€å•å³é«˜æ•ˆ**: SIEVEä»…ç”¨1 bitæ ‡è®°, å´å®ç°äº†ä¼˜å¼‚æ€§èƒ½
3. **å°ç¼“å­˜ä¼˜åŠ¿æ›´å¤§**: å½“èµ„æºå—é™æ—¶, SIEVEçš„ä¼˜åŠ¿æ›´åŠ æ˜æ˜¾
4. **ååé‡æœ€é«˜**: SIEVEåœ¨æ‰€æœ‰æµ‹è¯•ä¸­ååé‡æœ€é«˜æˆ–å¹¶åˆ—æœ€é«˜

---

## é™„å½•: å…³é”®å‘½ä»¤

```bash
# ç”ŸæˆZipf trace
python3 libCacheSim/scripts/data_gen.py -m 10000 -n 1000000 --alpha 1.0 > trace.txt

# è¿è¡Œå•ä¸ªå®éªŒ
./libCacheSim/_build/bin/cachesim trace.txt txt sieve 500 --ignore-obj-size 1

# è¿è¡Œå®Œæ•´å®éªŒå¥—ä»¶
./run_all.sh --full

# ç”ŸæˆCase Study
python3 case_study.py
```
